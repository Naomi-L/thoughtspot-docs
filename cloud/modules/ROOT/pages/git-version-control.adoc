= Version control for Liveboards and Answers
:last_updated: 6/25/2024
:author: Mark
:experimental:
:linkattrs:
:page-layout: default-cloud
:description: Enable version control on your ThoughtSpot cluster, so users can enable version control on specific Liveboards and Answers.
:jira: SCAL-196890, SCAL-185652 (can manage version control privilege), SCAL-207739 (troubleshooting), SCAL-213208 (change to GA)

With version control, every time a user saves changes to a Liveboard or Answer, a new version is created and stored in Github. Any user with edit access to the Liveboard or Answer can browse the version history in ThoughtSpot and restore any saved versions whenever needed. Version control must be enabled at the Org level. After that, it can be enabled on specific Liveboards and Answers where version control is wanted.

There are two steps to enabling version control in ThoughtSpot, which must be done in the following order:

. Enable version control for the Org.
. Enable version control for specific Liveboards or Answers in the Org.

IMPORTANT: Version control cannot be enabled by default for all Liveboards and Answers.

== Version control for an Org

=== Prerequisites

To enable version control for an Org, the following are required:

* Administrator access to the cluster/Org
* GitHub repository created in Github or GitHub Enterprise
* Github user ID of admin who has access to the repository
* Github repository configured with:

** One commit branch for _each Org_ where you are enabling version control
*** TML files for each Liveboard and Answer enabled for version control are stored here.
** One configuration branch
*** A set of configuration files required for the GIT integration and CI/CD to work.
+
TIP: ThoughtSpot recommends *not* using the Main branch for either commits or configuration.
** Personal access token from Github (https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic[Classic^] or https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-fine-grained-personal-access-token[fine-grained^])
*** Under _Select scopes_, be sure to select the *repo* checkbox before clicking *Generate token*.

* The https URL to the Github repository.

=== Enabling version control for an Org

To enable version control for an Org, do the following:

. Go to the *Admin* tab.
. Select the Org where you want to enable version control.
. Under _Application settings_, select *Version Control*.
. Under the message "Version control not configured", Click *Configure*.
+
image::github-creds.png[Enter github credentials]

. In the _Enter Github Credentials_ window, do the following:
.. For _Repository_, enter the Github repository to store version control information.
.. For _Username_, enter your Github username.
.. For _Token_, enter or paste your personal access token associated with your Github username.
+
If you don't a have personal access token yet, sign in to Github and create one of the following access tokens, and enter it in the _Token_ field:

... https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-personal-access-token-classic[Classic^]
... https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/managing-your-personal-access-tokens#creating-a-fine-grained-personal-access-token[fine-grained^]
+
Under Select scopes be sure to select the repo checkbox before clicking *Generate token*.
. Click *Continue*.
. In the _Select Branch_ window, do the following:
* For _Commit branch_ select the commit branch you created in your repository.
* For _Configuration branch_ select the configuration branch you created in your repository.
* Make sure the *Save version history* checkbox is selected.
. Click *Enable*.


Version control is now enabled for your Org. In order for version control to be available for any Liveboard or Answer, it must be enabled individually in the Liveboard or Answer.

== Version control for a Liveboard or Answer

=== Prerequisites

To enable version control on a Liveboard or Answer, you must:

* Be in a group which is assigned the "Can manage version control" privilege
* Have edit permission on the Liveboard or Answer and the underlying datasource(s)

=== Enabling version control for a Liveboard or Answer

To enable version control for a Liveboard or Answer, do the following:

. Navigate to the Liveboard or Answer where you want to enable version control.
. Click the More menu image:icon-more-10px.png[more menu], and select *Enable Version Control*.

== Editing the version control configuration

After you enable version control for an Org, you can edit the configuration. However, changing these settings will cause a service interruption for all users of a few minutes. Consider making your changes during a scheduled maintenance window.

. Go to the *Admin* tab.
. Select the Org where you want to edit version control.
. Under _Application settings_, select *Version Control*.
. Click *Edit*.
. In the _Enter Github credentials_ window, Make any changes required to the Repository, Username, or Token and click *Continue*.
. In the _Select Branch_ window, make any changes required to the Commit and Configuration branches, make sure the Save version history checkbox is selected, and click *Update*.

== Resetting the version control configuration

CAUTION: Resetting your version control configuration, deletes the configuration completely, causing all version history from your GIT branches to be lost.

To reset the version control configuration, do the following:

. Click *Reset Configuration*.
+
The _Reset Configuration_ message appears asking you if you really want to reset the configuration.
. To proceed, click *Yes*.

== Troubleshooting

The following are some possible issues you may encounter and the recommended steps to resolve them:

[%collapsible]
.*Cannot select <BranchName> as it has protection rules enabled*
====
--
[discrete]
==== What are Branch protection rules?
Branch protection rules are configurations within version control systems like Git that safeguard designated branches from unauthorized or accidental changes. These rules typically include restrictions such as preventing direct pushes to protected branches, requiring code reviews for proposed changes, enforcing passing status checks before merging, mandating approvals from designated reviewers, and limiting or disallowing force pushes to maintain branch history integrity. By enforcing these rules, teams ensure a controlled and collaborative development process, reducing the risk of errors and conflicts while maintaining code quality and stability.

[discrete]
==== Why does it need to be disabled to create Git configuration in ThoughtSpot?
With Branch protection rules enabled, it’s impossible to directly commit and push the TS objects to the remote repository. So both the Commit branch and Configuration branch should not be protected.

[discrete]
==== How to disable the Branch protection rules?

. Navigate to your Git repository and open settings.
. Under 'Code and Automation', click on 'Branches'.
. Delete any branch protection rules specified for the branch from which you want to create a Git configuration.
. Finally, create the Git configuration in ThoughtSpot.


--
====
[%collapsible]
.*Git token about to expire, Contact your admin for uninterrupted access of version history*
====
--
[discrete]
==== What does this error mean?
The Git access token you're using to authenticate with Git (such as GitHub, GitLab, etc.) is nearing its expiration date. Git platforms commonly use access tokens for authentication when interacting with their APIs, such as when pushing commits, pulling changes, or performing other actions that require authentication.

[discrete]
==== Why does it need to be disabled to create Git configuration in ThoughtSpot?
With Branch protection rules enabled, it’s impossible to directly commit and push the TS objects to the remote repository. So both the Commit branch and Configuration branch should not be protected.

[discrete]
==== How to disable the Branch protection rules?
Navigate to your Git repository and open settings.
Under 'Code and Automation', click on 'Branches'.
Delete any branch protection rules specified for the branch from which you want to create a Git configuration.
Finally, create the Git configuration in ThoughtSpot.

[discrete]
==== Solution

. Sign in to your Github account and open the developer settings section.
. Find the section for managing personal access tokens.
. Review the token expiry settings on GitHub. Adjust the settings according to your requirements to avoid frequent token expiration issues.
. Generate a new token or Regenerate a token with the appropriate permissions required for your use case.

--
====

[%collapsible]
.*Version history is unavailable as connection with Github could not be established. Contact admin to restore services.*
====
--
[discrete]
==== Root cause

The access token you're using to authenticate with GitHub must be expired. GitHub commonly uses access tokens for authentication when interacting with their APIs, such as when pushing commits, pulling changes, or performing other actions that require authentication.

[discrete]
==== Solution

. Sign in to your Github account and open the developer settings section.
. Find the section for managing personal access tokens.
. Review the token expiry settings on GitHub. Adjust the settings according to your requirements to avoid frequent token expiration issues.
. Generate a new token or Regenerate a token with the appropriate permissions required for your use case.

--
====

[%collapsible]
.*Answers could not be loaded in Liveboard.*
====
--
[discrete]
==== Root cause

This error occurs when a table or column is needed to display visualizations in the version of the Liveboard that is being previewed, but no longer exists in ThoughtSpot (the table / worksheet used for these visualizations have likely changed recently and removed the tables / columns needed).

[discrete]
==== Solution for column not found

. Navigate to the data tab and open the respective worksheet or table.
. Click edit table option and import the column you need to search from ThoughtSpot.
. Navigate to the data tab and open the respective worksheet or table.
. Click edit table option and import the column you need to search from ThoughtSpot.

[discrete]
==== Solution for table not found

. Navigate to the data tab and open the connection where your table/worksheet belongs to.
. Click *Edit connection*.
. Import the column you need to search from ThoughtSpot.


--
====