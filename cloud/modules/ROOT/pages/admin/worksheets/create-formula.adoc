'''

title: [Create a formula in a worksheet]

last_updated: 3/20/2020 summary: "You can define formulas and use them to create derived columns in worksheets.
" sidebar: mydoc_sidebar permalink: /:collection/:path.html -- You create formulas by combining standard functions and operators, column names, and constant values.

Anyone who can create a worksheet can add a formula to it.
Formulas are not reusable;
the formula you create is associated only with the worksheet it belongs to.
A complete list of available formulas and examples of each is available in the link:{{ site.baseurl }}/reference/formula-reference.html#[Formula function reference].

You can create a formula in a worksheet by using the Formula Builder.
When you do this, the result of the formula gets added to the worksheet as a column.
Use these steps to create a formula:

. link:{{ site.baseurl }}/admin/worksheets/about-worksheets.html[Create a new worksheet], or link:{{ site.baseurl }}/admin/worksheets/edit-worksheet.html[edit an existing one].
. Click the *+* button next to *Formulas*.
+
image::{{ site.baseurl }}/images/worksheet-add-formula.png[Create a new formula for your worksheet]

. Type your formula in the Formula Builder.
+
image::{{ site.baseurl }}/images/worksheet-formula-profit-old.png[Use the Formula Builder]
+
NOTE: Formula elements are color coded by type and can include the formula operators and functions (blue), the names of columns (purple), and/or constants (black).

. You can see a list of formula operators with examples by clicking on *Formula Assistant.*
+
image::{{ site.baseurl }}/images/worksheet-formula-assistant-old.png[Formula Assistant]

. If you want to change what your formula returns, use the *Advanced settings*.
+
Depending on your formula, you may be able to change:

 ** *Data type*: Determines the type of data that the formula generates.
For example, use `date` for an `add_days` formula.
 ** *Measure or attribute*: Determines if the output of the formula is a measure or an attribute.
For example, choose `attribute` for a formula that generates age groups, and choose `measure` for a formula that generates profit.
 ** *Aggregation*: Determines the default aggregation of the formula output.
For example, choose `min` to see minimum profit.

+
image::{{ site.baseurl }}/images/worksheet-formula-settings-old.png[Advanced settings in the Formula Builder]

. Name the formula by clicking on its title and typing the new name.
Click *Save*.
